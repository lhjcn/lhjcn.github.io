import{u as F,a as k,J as x,k as i}from"./index-420onEHt.js";import{E}from"./exceljs-Ct0zeZlE.js";import{_}from"./vendor-C-jb08-1.js";import{E as y}from"./element-plus-SGNFsUZO.js";import{d as C}from"./@vue-BYKpmgQC.js";import"./cos-js-sdk-v5-p1FWqW2f.js";import"./ali-oss-Ci4CXxfL.js";import"./@element-plus-DmmXDu5M.js";const A=C({__name:"ExportExcel",setup(S,{expose:u}){const l=F(),d=k(),m=["名称","地址","用户名","密码","标签","备注","创建时间","收藏","自定义信息"],p=async e=>{if(e){await n(e);return}d.verifyPasswordRef.getAndVerify(o=>l.passwordManager.verifyPassword(o)).then(()=>{n(e)})},n=async e=>{const o=new E.Workbook,t=o.addWorksheet("Sheet1");t.addRow(m),e||l.allPasswordArray.map(s=>{let f="";s.labels&&s.labels.length&&(f=x(s.labels));let g=i(s.addTime,"YYYY-MM-DD HH:mm:ss"),c="";if(s.customFields&&s.customFields.length)for(let r=0;r<s.customFields.length;r++)c+=s.customFields[r].key+"："+s.customFields[r].val,r!==s.customFields.length-1&&(c+=`\r
`);return[s.title,s.address,s.username,s.password,f,s.remark,g,s.favorite?"是":"否",c]}).forEach(s=>{t.addRow(s)}),t.getRow(1).eachCell((a,s)=>{switch(a.fill={type:"pattern",pattern:"solid",fgColor:{argb:"00B0F0"}},a.font={bold:!0,color:{argb:"FFFFFF"}},s){case 1:t.getColumn(s).width=20;break;case 2:t.getColumn(s).width=30;break;case 3:case 4:case 5:case 6:case 7:t.getColumn(s).width=20;break;case 8:t.getColumn(s).width=10;break;case 9:t.getColumn(s).width=20;break}});const w=await o.xlsx.writeBuffer(),b=new Blob([w],{type:"application/octet-stream"}),h=e?"密码导入模板.xlsx":"密码导出_"+i(Date.now(),"YYYY-MM-DD HH:mm:ss")+".xlsx";_.saveAs(b,h),e||y.success({title:"密码导出成功",message:"请注意密码安全"})};return u({exportExcel:p}),(e,o)=>null}});export{A as default};
